!function e(t,a,r){function d(s,n){if(!a[s]){if(!t[s]){var l="function"==typeof require&&require;if(!n&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var i=a[s]={exports:{}};t[s][0].call(i.exports,(function(e){return d(t[s][1][e]||e)}),i,i.exports,e,t,a,r)}return a[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)d(r[s]);return d}({1:[function(e,t,a){const r=e("./card"),d=e("./list"),o=e("./tag"),s={base_url:"http://18.204.218.43:3000",init:function(){console.log("app.init !"),d.setBaseUrl(s.base_url),r.setBaseUrl(s.base_url),o.setBaseUrl(s.base_url),s.addListenerToActions(),d.getListsFromAPI()},addListenerToActions:()=>{document.getElementById("addListButton").addEventListener("click",d.showAddListModal);const e=document.querySelectorAll(".close");for(button of e)button.addEventListener("click",s.hideModals);document.querySelector("#formList").addEventListener("submit",s.handleAddListForm);const t=document.querySelectorAll(".plus-sign");for(buttonbis of t)buttonbis.addEventListener("click",r.showAddCardModal);document.querySelector("#formCard").addEventListener("submit",s.handleAddCardForm),document.getElementById("buttonDeleteAllList").addEventListener("click",d.deleteAllModal),document.getElementById("addTagButton").addEventListener("click",o.showManageTagsModal),document.querySelector("#formTag").addEventListener("submit",o.handleAddTagForm)},handleAddCardForm:e=>{e.preventDefault(),r.handleAddCardForm(e),s.hideModals()},handleAddListForm:e=>{e.preventDefault(),d.handleAddListForm(e),s.hideModals()},handleAddTagForm:e=>{e.preventDefault(),o.handleAddTagForm(e),s.hideModals()},handleEditListForm:(e,t)=>{t.preventDefault(),e.querySelector("form").classList.add("is-hidden"),e.querySelector("h2").classList.remove("is-hidden"),d.handleEditListForm(e,t)},handleEditCardForm:(e,t)=>{t.preventDefault(),e.querySelector("form").classList.add("is-hidden"),e.querySelector(".title-card").classList.remove("is-hidden"),r.handleEditCardForm(e,t)},handleEditTagForm:(e,t)=>{t.preventDefault(),e.querySelector("form").classList.add("is-hidden"),e.querySelector("h2").classList.remove("is-hidden"),o.handleEditTagForm(e,t)},hideModals:()=>{const e=document.querySelectorAll(".modal");for(modal of e)modal.classList.remove("is-active")}};document.addEventListener("DOMContentLoaded",s.init),t.exports=s},{"./card":2,"./list":3,"./tag":4}],2:[function(e,t,a){const r=e("./tag"),d={base_url:null,setBaseUrl(e){d.base_url=`${e}/cards`},showAddCardModal:e=>{const t=document.getElementById("addCardModal");t.classList.add("is-active");const a=e.target.closest(".panel").getAttribute("data-list-id");t.querySelector('input[type="hidden"]').value=a},handleAddCardForm:async e=>{const t=new FormData(e.target);try{const e=await fetch(d.base_url,{method:"POST",body:t});if(!e.ok)throw new Error(e.status);const a=await e.json();d.makeCardInDOM(a)}catch(e){alert(e)}},makeCardInDOM:e=>{const t=document.querySelector("#card-template"),a=document.importNode(t.content,!0);a.querySelector(".box").style.backgroundColor=e.color;a.querySelector(".title-card").textContent=e.title;const o=document.querySelector(`[data-list-id = "${e.list_id}"]`);a.querySelector("[data-card-id]").dataset.cardId=e.id,a.querySelector(".pencil").addEventListener("click",d.showFormEditCard),a.querySelector("#delete-card").addEventListener("click",d.deleteModal),a.querySelector("#btnAssociateTag").addEventListener("click",r.showAssociateCardTagModal),o.querySelector(".panel-block").append(a)},showFormEditCard:e=>{const t=e.target.closest(".panel"),a=e.target.closest(".box"),r=a.querySelector("form");r.classList.remove("is-hidden"),a.querySelector(".title-card").classList.add("is-hidden");r.querySelector('input[type="hidden"]').value=t.dataset.listId,r.addEventListener("submit",(e=>{app.handleEditCardForm(a,e)})),r.querySelector(".close").addEventListener("click",(()=>{r.classList.add("is-hidden"),a.querySelector(".title-card").classList.remove("is-hidden")}))},handleEditCardForm:async(e,t)=>{const a=new FormData(t.target),r=e.dataset.cardId;try{const t=await fetch(d.base_url+`/${r}`,{method:"PATCH",body:a});if(!t.ok)throw new Error(t.status);const o=await t.json();e.querySelector(".title-card").textContent=o.title,e.style.backgroundColor=o.color}catch(e){alert(e)}},deleteCard:async e=>{const t=e.target.closest(".modal").querySelector("input").value;try{const e=await fetch(d.base_url+`/${t}`,{method:"DELETE"});if(!e.ok)throw new Error(e.status);d.deleteCardInDOM(t)}catch(e){alert(e)}},deleteCardInDOM:async e=>{document.querySelector(`[data-card-id="${e}"]`).remove(),document.querySelector("#deleteCard").classList.remove("is-active")},deleteModal(e){document.querySelector("#deleteCard").classList.add("is-active");const t=e.target.closest(".box").getAttribute("data-card-id"),a=document.querySelector("#deleteCard");a.querySelector("#deleteCardInput").value=`${t}`,a.querySelector(".danger").addEventListener("click",d.deleteCard)}};t.exports=d},{"./tag":4}],3:[function(e,t,a){const r=e("./app"),d=e("./card"),o=e("./tag"),s={base_url:null,setBaseUrl(e){s.base_url=`${e}/lists`},getListsFromAPI:async()=>{try{const e=await fetch(s.base_url,{method:"GET"}),t=await e.json();for(const e of t){s.makeListInDOM(e);for(const t of e.cards){d.makeCardInDOM(t);for(const e of t.tags)o.makeTagInDOM(e,t.id)}}const a=document.querySelector(".card-lists");new Sortable(a,{animation:300,onEnd:s.handleDropList})}catch(e){alert(e)}},showAddListModal:()=>{document.getElementById("addListModal").classList.add("is-active")},handleAddListForm:async e=>{const t=new FormData(e.target);try{const e=await fetch(s.base_url,{method:"POST",body:t});if(!e.ok)throw new Error(e.status);const a=await e.json();s.makeListInDOM(a)}catch(e){alert(e)}},showFormEditList:e=>{const t=e.target.closest(".panel"),a=t.querySelector("form");a.classList.remove("is-hidden");t.querySelector("h2").classList.add("is-hidden");a.querySelector('input[type="hidden"]').value=t.dataset.listId,a.addEventListener("submit",(e=>{r.handleEditListForm(t,e)}))},handleEditListForm:async(e,t)=>{const a=new FormData(t.target),r=a.get("list-id");try{const t=await fetch(s.base_url+`/${r}`,{method:"PATCH",body:a});if(!t.ok)throw new Error(t.status);const d=await t.json();e.querySelector("h2").textContent=d.name}catch(e){alert(e)}},makeListInDOM:e=>{const t=document.querySelector("#list-template"),a=document.importNode(t.content,!0);a.querySelector(".title-list").textContent=e.name;a.querySelector("[data-list-id]").dataset.listId=e.id;const r=document.querySelector(".card-lists");a.querySelector(".plus-sign").addEventListener("click",d.showAddCardModal);a.querySelector(".title-list").addEventListener("dblclick",s.showFormEditList),a.querySelector("#delete-list").addEventListener("click",s.deleteModal),r.append(a)},deleteList:async e=>{const t=e.target.closest(".modal").querySelector("input").value;try{const e=await fetch(s.base_url+`/${t}`,{method:"DELETE"});if(!e.ok)throw new Error(e.status);s.deleteListInDOM(t)}catch(e){alert(e)}},deleteListInDOM:async e=>{document.querySelector(`[data-list-id="${e}"]`).remove(),document.querySelector("#deleteList").classList.remove("is-active")},deleteModal(e){document.querySelector("#deleteList").classList.add("is-active");const t=e.target.closest(".panel").getAttribute("data-list-id"),a=document.querySelector("#deleteList");a.querySelector("#deleteListInput").value=`${t}`,a.querySelector(".danger").addEventListener("click",s.deleteList)},deleteAllModal:()=>{document.querySelector("#deleteAllList").classList.add("is-active");document.querySelector("#deleteAllList").querySelector(".button.danger").addEventListener("click",s.deleteAllLists)},deleteAllLists:async()=>{r.hideModals();try{const e=await fetch(s.base_url,{method:"DELETE"});if(!e.ok)throw new Error(e.status);document.querySelector(".card-lists").textContent=""}catch(e){alert(e)}},handleDropList:e=>{const t=e.target.querySelectorAll("[data-list-id]");for(const[e,a]of t.entries()){const t=a.getAttribute("data-list-id"),r=new FormData;r.set("position",e),fetch(`${s.base_url}/${t}`,{method:"PATCH",body:r})}}};t.exports=s},{"./app":1,"./card":2,"./tag":4}],4:[function(e,t,a){const r={base_url:null,setBaseUrl(e){r.base_url=`${e}`},showManageTagsModal(){document.getElementById("addTagModal").classList.add("is-active")},handleAddTagForm:async e=>{e.preventDefault();const t=new FormData(e.currentTarget);try{const e=await fetch(`${r.base_url}/tags`,{method:"POST",body:t});if(!e.ok)throw new Error(e.status);await e.json()}catch(e){alert(e)}},async showAssociateCardTagModal(e){console.log("je suis dans showtruc");const t=e.target;t.closest("[data-card-id]"),t.getAttribute("data-card-id");const a=document.getElementById("addAssociationTagModal");a.classList.add("is-active");try{const e=await fetch(`${r.base_url}/tags`);if(!e.ok)throw new Error(e.status);const d=await e.json(),o=a.querySelector(".tags-list");o.setAttribute("data-card-id",t),o.textContent="",console.log("avant for");for(const e of d){const t=document.createElement("span");t.classList.add("tagItem"),t.setAttribute("data-tag-id",e.id),t.textContent=e.name,t.style.backgroundColor=e.color,t.style.marginRight="5px",t.addEventListener("click",r.handleAssociateTagToCard),console.log("coucou avant tag"),o.append(t),console.log("coucou apres tag")}}catch(e){alert(e)}},async handleAssociateTagToCard(e){const t=e.currentTarget,a=t.getAttribute("data-tag-id"),d=t.closest("[data-card-id]").getAttribute("data-card-id");try{const e=new FormData;e.set("tag_id",a);const t=await fetch(`${r.base_url}/cards/${d}/tags`,{method:"POST",body:e});if(!t.ok)throw new Error(t.status);const o=await fetch(`${r.base_url}/tags/${a}`);if(!o.ok)throw new Error(o.status);const s=await o.json();r.makeTagInDOM(s,d)}catch(e){alert(e)}},makeTagInDOM(e,t){const a=document.createElement("span");a.setAttribute("data-tag-id",e.id),a.textContent=e.name,a.style.backgroundColor=e.color,a.style.marginRight="5px",document.querySelector(`[data-card-id="${t}"] .tags-list`).append(a)}};t.exports=r},{}]},{},[1]);
