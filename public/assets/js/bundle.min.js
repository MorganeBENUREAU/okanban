!function t(e,a,r){function d(s,n){if(!a[s]){if(!e[s]){var l="function"==typeof require&&require;if(!n&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var i=a[s]={exports:{}};e[s][0].call(i.exports,(function(t){return d(e[s][1][t]||t)}),i,i.exports,t,e,a,r)}return a[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)d(r[s]);return d}({1:[function(t,e,a){const r=t("./card"),d=t("./list"),o=t("./tag"),s={base_url:"http://18.204.218.43:3000",init:function(){console.log("app.init !"),d.setBaseUrl(s.base_url),r.setBaseUrl(s.base_url),o.setBaseUrl(s.base_url),s.addListenerToActions(),d.getListsFromAPI()},addListenerToActions:()=>{document.getElementById("addListButton").addEventListener("click",d.showAddListModal);const t=document.querySelectorAll(".close");for(button of t)button.addEventListener("click",s.hideModals);document.querySelector("#formList").addEventListener("submit",s.handleAddListForm);const e=document.querySelectorAll(".plus-sign");for(buttonbis of e)buttonbis.addEventListener("click",r.showAddCardModal);document.querySelector("#formCard").addEventListener("submit",s.handleAddCardForm),document.getElementById("buttonDeleteAllList").addEventListener("click",d.deleteAllModal),document.getElementById("addTagButton").addEventListener("click",o.showManageTagsModal),document.querySelector("#formTag").addEventListener("submit",o.handleAddTagForm)},handleAddCardForm:t=>{t.preventDefault(),r.handleAddCardForm(t),s.hideModals()},handleAddListForm:t=>{t.preventDefault(),d.handleAddListForm(t),s.hideModals()},handleAddTagForm:t=>{t.preventDefault(),o.handleAddTagForm(t),s.hideModals()},handleEditListForm:(t,e)=>{e.preventDefault(),t.querySelector("form").classList.add("is-hidden"),t.querySelector("h2").classList.remove("is-hidden"),d.handleEditListForm(t,e)},handleEditCardForm:(t,e)=>{e.preventDefault(),t.querySelector("form").classList.add("is-hidden"),t.querySelector(".title-card").classList.remove("is-hidden"),r.handleEditCardForm(t,e)},handleEditTagForm:(t,e)=>{e.preventDefault(),t.querySelector("form").classList.add("is-hidden"),t.querySelector("h2").classList.remove("is-hidden"),o.handleEditTagForm(t,e)},hideModals:()=>{const t=document.querySelectorAll(".modal");for(modal of t)modal.classList.remove("is-active")}};document.addEventListener("DOMContentLoaded",s.init),e.exports=s},{"./card":2,"./list":3,"./tag":4}],2:[function(t,e,a){const r=t("./app"),d=t("./tag"),o={base_url:null,setBaseUrl(t){o.base_url=`${t}/cards`},showAddCardModal:t=>{const e=document.getElementById("addCardModal");e.classList.add("is-active");const a=t.target.closest(".panel").getAttribute("data-list-id");e.querySelector('input[type="hidden"]').value=a},handleAddCardForm:async t=>{const e=new FormData(t.target);try{const t=await fetch(o.base_url,{method:"POST",body:e});if(!t.ok)throw new Error(t.status);const a=await t.json();o.makeCardInDOM(a)}catch(t){alert(t)}},makeCardInDOM:t=>{const e=document.querySelector("#card-template"),a=document.importNode(e.content,!0);a.querySelector(".box").style.backgroundColor=t.color;a.querySelector(".title-card").textContent=t.title;const r=document.querySelector(`[data-list-id = "${t.list_id}"]`);a.querySelector("[data-card-id]").dataset.cardId=t.id,a.querySelector(".pencil").addEventListener("click",o.showFormEditCard),a.querySelector("#delete-card").addEventListener("click",o.deleteModal),a.querySelector("#btnAssociateTag").addEventListener("click",d.showAssociateCardTagModal),r.querySelector(".panel-block").append(a)},showFormEditCard:t=>{const e=t.target.closest(".panel"),a=t.target.closest(".box"),d=a.querySelector("form");d.classList.remove("is-hidden"),a.querySelector(".title-card").classList.add("is-hidden");d.querySelector('input[type="hidden"]').value=e.dataset.listId,d.addEventListener("submit",(t=>{r.handleEditCardForm(a,t)})),d.querySelector(".close").addEventListener("click",(()=>{d.classList.add("is-hidden"),a.querySelector(".title-card").classList.remove("is-hidden")}))},handleEditCardForm:async(t,e)=>{const a=new FormData(e.target),r=t.dataset.cardId;try{const e=await fetch(o.base_url+`/${r}`,{method:"PATCH",body:a});if(!e.ok)throw new Error(e.status);const d=await e.json();t.querySelector(".title-card").textContent=d.title,t.style.backgroundColor=d.color}catch(t){alert(t)}},deleteCard:async t=>{const e=t.target.closest(".modal").querySelector("input").value;try{const t=await fetch(o.base_url+`/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(t.status);o.deleteCardInDOM(e)}catch(t){alert(t)}},deleteCardInDOM:async t=>{document.querySelector(`[data-card-id="${t}"]`).remove(),document.querySelector("#deleteCard").classList.remove("is-active")},deleteModal(t){document.querySelector("#deleteCard").classList.add("is-active");const e=t.target.closest(".box").getAttribute("data-card-id"),a=document.querySelector("#deleteCard");a.querySelector("#deleteCardInput").value=`${e}`,a.querySelector(".danger").addEventListener("click",o.deleteCard)}};e.exports=o},{"./app":1,"./tag":4}],3:[function(t,e,a){const r=t("./app"),d=t("./card"),o=t("./tag"),s={base_url:null,setBaseUrl(t){s.base_url=`${t}/lists`},getListsFromAPI:async()=>{try{const t=await fetch(s.base_url,{method:"GET"}),e=await t.json();for(const t of e){s.makeListInDOM(t);for(const e of t.cards){d.makeCardInDOM(e);for(const t of e.tags)o.makeTagInDOM(t)}}const a=document.querySelector(".card-lists");new Sortable(a,{animation:300,onEnd:s.handleDropList})}catch(t){alert(t)}},showAddListModal:()=>{document.getElementById("addListModal").classList.add("is-active")},handleAddListForm:async t=>{const e=new FormData(t.target);try{const t=await fetch(s.base_url,{method:"POST",body:e});if(!t.ok)throw new Error(t.status);const a=await t.json();s.makeListInDOM(a)}catch(t){alert(t)}},showFormEditList:t=>{const e=t.target.closest(".panel"),a=e.querySelector("form");a.classList.remove("is-hidden");e.querySelector("h2").classList.add("is-hidden");a.querySelector('input[type="hidden"]').value=e.dataset.listId,a.addEventListener("submit",(t=>{r.handleEditListForm(e,t)}))},handleEditListForm:async(t,e)=>{const a=new FormData(e.target),r=a.get("list-id");try{const e=await fetch(s.base_url+`/${r}`,{method:"PATCH",body:a});if(!e.ok)throw new Error(e.status);const d=await e.json();t.querySelector("h2").textContent=d.name}catch(t){alert(t)}},makeListInDOM:t=>{const e=document.querySelector("#list-template"),a=document.importNode(e.content,!0);a.querySelector(".title-list").textContent=t.name;a.querySelector("[data-list-id]").dataset.listId=t.id;const r=document.querySelector(".card-lists");a.querySelector(".plus-sign").addEventListener("click",d.showAddCardModal);a.querySelector(".title-list").addEventListener("dblclick",s.showFormEditList),a.querySelector("#delete-list").addEventListener("click",s.deleteModal),r.append(a)},deleteList:async t=>{const e=t.target.closest(".modal").querySelector("input").value;try{const t=await fetch(s.base_url+`/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(t.status);s.deleteListInDOM(e)}catch(t){alert(t)}},deleteListInDOM:async t=>{document.querySelector(`[data-list-id="${t}"]`).remove(),document.querySelector("#deleteList").classList.remove("is-active")},deleteModal(t){document.querySelector("#deleteList").classList.add("is-active");const e=t.target.closest(".panel").getAttribute("data-list-id"),a=document.querySelector("#deleteList");a.querySelector("#deleteListInput").value=`${e}`,a.querySelector(".danger").addEventListener("click",s.deleteList)},deleteAllModal:()=>{document.querySelector("#deleteAllList").classList.add("is-active");document.querySelector("#deleteAllList").querySelector(".button.danger").addEventListener("click",s.deleteAllLists)},deleteAllLists:async()=>{r.hideModals();try{const t=await fetch(s.base_url,{method:"DELETE"});if(!t.ok)throw new Error(t.status);document.querySelector(".card-lists").textContent=""}catch(t){alert(t)}},handleDropList:t=>{const e=t.target.querySelectorAll("[data-list-id]");for(const[t,a]of e.entries()){const e=a.getAttribute("data-list-id"),r=new FormData;r.set("position",t),fetch(`${s.base_url}/${e}`,{method:"PATCH",body:r})}}};e.exports=s},{"./app":1,"./card":2,"./tag":4}],4:[function(t,e,a){const r={base_url:null,setBaseUrl(t){r.base_url=`${t}`},showManageTagsModal(){document.getElementById("addTagModal").classList.add("is-active")},handleAddTagForm:async t=>{t.preventDefault();const e=new FormData(t.currentTarget);try{const t=await fetch(`${r.base_url}/tags`,{method:"POST",body:e});if(!t.ok)throw new Error(t.status);await t.json()}catch(t){alert(t)}},async showAssociateCardTagModal(t){const e=t.target;e.closest("[data-card-id]"),e.getAttribute("data-card-id");const a=document.getElementById("addAssociationTagModal");a.classList.add("is-active");try{const t=await fetch(`${r.base_url}/tags`);if(!t.ok)throw new Error(t.status);const d=await t.json(),o=a.querySelector(".tags-list");o.setAttribute("data-card-id",e),o.textContent="";for(const t of d){const e=document.createElement("span");e.classList.add("tagItem"),e.setAttribute("data-tag-id",t.id),e.textContent=t.name,e.style.backgroundColor=t.color,e.style.marginRight="5px",e.addEventListener("click",r.handleAssociateTagToCard),o.append(e)}}catch(t){alert(t)}},async handleAssociateTagToCard(t){const e=t.currentTarget,a=e.getAttribute("data-tag-id"),d=e.closest("[data-card-id]").getAttribute("data-card-id");try{const t=new FormData;t.set("tag_id",a);const e=await fetch(`${r.base_url}/cards/${d}/tags`,{method:"POST",body:t});if(!e.ok)throw new Error(e.status);const o=await fetch(`${r.base_url}/tags/${a}`);if(!o.ok)throw new Error(o.status);const s=await o.json();r.makeTagInDOM(s,d)}catch(t){alert(t)}},makeTagInDOM(t,e){const a=document.createElement("span");a.setAttribute("data-tag-id",t.id),a.textContent=t.name,a.style.backgroundColor=t.color,a.style.marginRight="5px",document.querySelector(`[data-card-id="${e}"] .tags-list`).append()}};e.exports=r},{}]},{},[1]);
